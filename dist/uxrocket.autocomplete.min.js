/*! UX Rocket Autocomplete 
 *  UX Rocket Autocomplete: A jQueryUI autocomplete wrapper 
 *  @author Bilal Cinarli <bcinarli@gmail.com> (http://bcinarli.com/) 
 *  @version 2.0.0 
 *  @build 2015-07-04 
 */
!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):t("object"==typeof exports&&"function"==typeof require?require("jquery"):jQuery)}(function(t){"use strict";var e,s=1,a="uxrAutocomplete",i={type:"list",item:10,service:null,minLength:2,queryType:"GET",formdata:null,hidden:null,template:null,highlight:!0,arrowSelection:!1,arrowNavigation:!0,cache:!1,onReady:!1,onSearch:!1,onSelect:!1,onButtonClick:!1,onClearCache:!1,onUpdate:!1,onRemove:!1},n={list:{item:'<li class="uxr-autocomplete-list-item">   <a {{#if url}}href="{{url}}"{{/if}}>       {{{name}}}       {{#if title}}       <br /><em>{{substr title 50}}</em>       {{/if}}   </a></li>'},image:{item:'<li class="uxr-autocomplete-list-item">   <a {{#if url}}href="{{url}}"{{/if}}>       <span class="item-image"><img src="{{image}}"/></span>        {{{name}}}       {{#if title}}       <br /><em>{{substr title 50}}</em>       {{/if}}   </a></li>'},category:{head:'<li class="uxr-autocomplete-category">   <span class="uxr-autocomplete-category-head" title="{{category}}">{{substr category 25}}</span></li>',item:'<li class="uxr-autocomplete-list-item">   <a {{#if url}}href="{{url}}"{{/if}}>       {{{name}}}   </a></li>'},tree:{head:'<li class="uxr-autocomplete-category">   <span class="uxr-autocomplete-category-head" title="{{category}}">{{substr category 25}}</span></li>',item:'<li class="uxr-autocomplete-list-item">   <a {{#if url}}href="{{url}}"{{/if}}>       <span class="item-image"><img src="{{image}}"/></span>        {{{name}}}   </a></li>'}},o={click:"click."+a,keyup:"keyup."+a,blur:"blur."+a},r={prefix:"uxr-",rocket:"uxRocket",data:a,name:"autocomplete",wrap:"uxr-plugin-wrap",classes:{wrap:"wrap",ready:"ready",magnify:"magnify",loading:"loading",select:"select",category:"category",option:"option",matched:"matched"}},l=function(e,n,o){var r=t(e);this._instance=s,this._name=a,this._defaults=i,this.el=e,this.$el=r,this.id="uxr-autocomplete-select-"+s,this.selector=o,this.terms={},this.options=t.extend(!0,{},i,n,r.data()),s++,this.lastTerm="as",this.init()};t.extend(l.prototype,{init:function(){var t=this.$el.data(r.rocket)||{};this.$el.addClass(c.getClassname("ready")),t[r.data]={hasWrapper:!0,wrapper:r.wrap,ready:c.getClassname("ready"),selector:this.selector,options:this.options},this.$el.data(r.rocket,t),this.setLayout(),this.prepareContainer(),this.prepareSource(),c.callback(this.options.onReady),this.bindUIActions(),this.setTemplate()},handleClasses:function(){this.classList=this.$el.context.className.replace(c.getClassname("ready"),""),"."===this.selector.charAt(0)&&(this.classList=this.classList.replace(this.selector.substr(1),"")),this.classList+=r.wrap+" "+c.getClassname("wrap"),this.classList=t.trim(this.classList)},removeClasses:function(){this.$el.removeClass(c.getClassname("ready")),this.$el.parent().removeClass(this.classList.replace(r.wrap,""))},handleWrapper:function(){this.$el.parent().is("."+r.wrap)?this.$el.parent().addClass(this.classList):this.$el.wrap('<span class="'+this.classList+'"></span>')},addIcon:function(){this.$el.after('<i class="'+c.getClassname("magnify")+'"></i>'),this.$icon=this.$el.next("."+c.getClassname("magnify"))},setLayout:function(){this.handleClasses(),this.handleWrapper(),this.addIcon()},startLoading:function(){this.$icon.addClass(c.getClassname("loading"))},stopLoading:function(){this.$icon.removeClass(c.getClassname("loading"))},removeLayout:function(){var t=this,e=t.$el.data(r.rocket);Object.keys&&1===Object.keys(e).length?t.$el.unwrap():t.$el.parent().removeClass(r.wrap),t.$el.next("."+c.getClassname("magnify")).remove()},setTemplate:function(){this.template=null,this.template=null===this.options.template?n[this.options.type]||n.list:this.options.template},bindUIActions:function(){var e=this;e.$el.on(o.keyup,function(s){var a=t(this).val(),i=a.length;e.lastTerm=a.toLowerCase(),i>=e.options.minLength&&e.onKeyup(s)}),e.$el.on(o.blur,function(t){e.onBlur(t)})},unbindUIActions:function(){this.$el.off("."+a)},onKeyup:function(t){38===t.keyCode||40===t.keyCode?this.onVerticalArrow():this.search()},onBlur:function(e){t("#"+this.id).delay(100).hide()},onVerticalArrow:function(){!this.$list.is(":visible")&&this.lastTerm.length>=this.options.minLength&&this.$list.show()},prepareContainer:function(){var e=t("<ul></ul>");this.setPosition(e),e.attr("id",this.id).addClass(c.getClassname("select")).css("display","none").appendTo("body"),this.$list=e},prepareSource:function(){var e=this,s=/^(http|https|\/|\.\/|\.\.\/)/,a=this.options.service;this.source=a,"string"==typeof a&&(this.source=s.test(a)?function(){var s=e.serializeForm();t.ajax({url:a,dataType:"json",type:this.options.queryType,data:{term:this.lastTerm,type:this.options.type,formdata:s},success:function(t){var s=t.itemList||t;e.showResults(s)}})}:c.getStringVariable(a))},search:function(){var e,s=this,a=this.source.itemList?this.source.itemList:this.source;return this.startLoading(),this.isCached()?void this.showResults(this.terms[this.lastTerm]):"function"==typeof a?a.apply(this):(e=t.map(a,function(t){return s.searchArray(t,s.lastTerm)?t:void 0}),void this.showResults(e))},searchArray:function(t,e){return t.name.toLowerCase().indexOf(e)>-1},showResults:function(e){var s=this.compileTemplate(e);c.callback(this.options.onSearch),this.cache(e),t("#"+this.id).html(s).show(),this.stopLoading()},setPosition:function(t){var e=this.$el.offset(),s=e.top+this.el.offsetHeight,a=e.left,i=this.el.offsetWidth;return t.css({top:s,left:a,minWidth:i})},compileTemplate:function(e){var s=this,a=[],i=Handlebars.compile(this.template.item),n=this.template.head?Handlebars.compile(this.template.head):!1,o="";return t.each(e,function(e,r){var l;if(l=s.renderItem(r,i),("category"===s.options.type||"tree"===s.options.type)&&"undefined"!=typeof r.category&&r.category!==o){var h=t(n(r));h.addClass(c.getClassname("category")).attr("role","presentation"),a.push(h),o=r.category}a.push(l)}),a},renderItem:function(e,s){var a=this,i=s(e);return a.options.highlight===!0&&(i=i.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+a.lastTerm+")(?![^<>]*>)(?![^&;]+;)","gi"),'<span class="'+c.getClassname("matched")+'">$1</span>')),t(i).addClass(c.getClassname("option")).data("uxrAutocompleteItem",e).attr("role","presentation")},serializeForm:function(){return t(this.options.formdata).serialize()},cache:function(t){this.options.cache===!0&&(this.terms[this.lastTerm]=t)},isCached:function(){var t=!1;return void 0!==this.terms[this.lastTerm]&&(t=!0),t},clearCache:function(){return e.clearCache(this.el)},update:function(){return e.update(this.el)},destroy:function(){return e.destroy(this.el)}});var c={callback:function(t){if("function"==typeof t)t.apply(this);else if(t!==!1){var e=function(){return t};e()}},getStringVariable:function(t){var e;if(t.indexOf(".")>-1){for(var s=t.split("."),a=window[s[0]],i=1;i<s.length;i++)a=a[s[i]];e=a}else e=window[t];return e},getClassname:function(t){return r.prefix+r.name+"-"+r.classes[t]}};e=t.fn.uxrautocomplete=t.fn.uxitdautocomplete=t.uxrautocomplete=function(e){var s=this.selector;return this.each(function(){t.data(this,r.data)||t.data(this,r.data,new l(this,e,s))})},e.clearCache=function(e){var s=t(void 0!==e?e:"."+c.getClassname("ready"));s.each(function(){var e=t(this).data(r.data);e.terms={},c.callback(e.options.onClearCache)})},e.update=function(t){},e.destroy=function(e){var s=t(void 0!==e?e:"."+c.getClassname("ready"));s.filter("input").each(function(){var e=t(this),s=e.data(r.data),a=e.data(r.rocket);s.removeClasses(),s.unbindUIActions(),s.removeLayout(),e.removeData(r.data),delete a[r.data],e.data(r.rocket,a),c.callback(s.options.onRemove)})},e.version="2.0.0",e.settings=i,e.templates=n,e.namespace=r}),Object.keys=Object.keys||function(t,e,s){s=[];for(e in t)s.hasOwnProperty.call(t,e)&&s.push(e);return s};
//# sourceMappingURL=uxrocket.autocomplete.min.js.map